Started by user [8mha:AAAAlh+LCAAAAAAAAP9b85aBtbiIQTGjNKU4P08vOT+vOD8nVc83PyU1x6OyILUoJzMv2y+/JJUBAhiZGBgqihhk0NSjKDWzXb3RdlLBUSYGJk8GtpzUvPSSDB8G5tKinBIGIZ+sxLJE/ZzEvHT94JKizLx0a6BxUmjGOUNodHsLgAzOEgYu/dLi1CL9vNKcHACFIKlWvwAAAA==[0manonymous
Building in workspace /home/wen/Github/wakaj/work/jobs/aaaa/workspace
[workspace] $ /bin/sh -xe /tmp/hudson8597653284009120520.sh
+ echo ImageName=docker-reg-bj.afmobitek.com:5000/user-server/debug:v7e6243b
{"id":"1s192","type":"service","links":{"self":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192","account":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/account","consumedbyservices":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/consumedbyservices","consumedservices":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/consumedservices","instances":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/instances","networkDrivers":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/networkdrivers","serviceExposeMaps":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/serviceexposemaps","serviceLogs":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/servicelogs","stack":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/stack","storageDrivers":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/storagedrivers","containerStats":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/containerstats"},"actions":{"update":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/?action=update","remove":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/?action=remove","removeservicelink":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/?action=removeservicelink","addservicelink":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/?action=addservicelink","cancelupgrade":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/?action=cancelupgrade","setservicelinks":"http:\/\/10.240.36.216:8080\/v2-beta\/projects\/1a5\/services\/1s192\/?action=setservicelinks"},"baseType":"service","name":"user-server-test","state":"finishing-upgrade","accountId":"1a5","assignServiceIpAddress":false,"createIndex":4,"created":"2017-09-04T06:17:32Z","createdTS":1504505852000,"currentScale":1,"description":"user-server-test","externalId":null,"fqdn":null,"healthState":"healthy","instanceIds":["1i10118","1i10119"],"kind":"service","launchConfig":{"type":"launchConfig","capAdd":[],"capDrop":[],"dataVolumes":["\/data\/logs:\/data\/logs"],"dataVolumesFrom":[],"devices":[],"dns":[],"dnsSearch":[],"environment":{"ProjectName":"user-server","NAME":"userserver","ETCD_ADDR":"http:\/\/10.240.36.209:2379,http:\/\/10.240.36.210:2379,http:\/\/10.240.36.211:2379"},"imageUuid":"docker:docker-reg-bj.afmobitek.com:5000\/user-server\/debug:v7e6243b","instanceTriggeredStop":"stop","kind":"container","labels":{"io.rancher.container.pull_image":"always","io.rancher.scheduler.affinity:host_label":"captcha=1"},"logConfig":{"type":"logConfig","config":{},"driver":null},"networkMode":"managed","ports":["6005:8080\/tcp"],"privileged":false,"publishAllPorts":false,"readOnly":false,"secrets":[],"startOnCreate":true,"stdinOpen":true,"system":false,"tty":true,"version":"69134f99-e7cb-47c2-8bd3-f47a1ed7abf0","dataVolumesFromLaunchConfigs":[],"vcpu":1},"lbConfig":null,"linkedServices":null,"metadata":null,"publicEndpoints":[{"type":"publicEndpoint","hostId":"1h4","instanceId":"1i10119","ipAddress":"10.240.36.217","port":6005,"serviceId":"1s192"}],"removed":null,"retainIp":null,"scale":1,"scalePolicy":null,"secondaryLaunchConfigs":[],"selectorContainer":null,"selectorLink":null,"stackId":"1st16","startOnCreate":true,"system":false,"transitioning":"yes","transitioningMessage":"In Progress","transitioningProgress":null,"upgrade":{"type":"serviceUpgrade","inServiceStrategy":{"type":"inServiceUpgradeStrategy","batchSize":1,"intervalMillis":2000,"launchConfig":{"type":"launchConfig","capAdd":[],"capDrop":[],"dataVolumes":["\/data\/logs:\/data\/logs"],"dataVolumesFrom":[],"devices":[],"dns":[],"dnsSearch":[],"environment":{"ProjectName":"user-server","NAME":"userserver","ETCD_ADDR":"http:\/\/10.240.36.209:2379,http:\/\/10.240.36.210:2379,http:\/\/10.240.36.211:2379"},"imageUuid":"docker:docker-reg-bj.afmobitek.com:5000\/user-server\/debug:v7e6243b","instanceTriggeredStop":"stop","kind":"container","labels":{"io.rancher.container.pull_image":"always","io.rancher.scheduler.affinity:host_label":"captcha=1"},"logConfig":{"type":"logConfig","config":{},"driver":null},"networkMode":"managed","ports":["6005:8080\/tcp"],"privileged":false,"publishAllPorts":false,"readOnly":false,"secrets":[],"startOnCreate":true,"stdinOpen":true,"system":false,"tty":true,"version":"69134f99-e7cb-47c2-8bd3-f47a1ed7abf0","dataVolumesFromLaunchConfigs":[],"vcpu":1},"previousLaunchConfig":{"type":"launchConfig","capAdd":[],"capDrop":[],"dataVolumes":["\/data\/logs:\/data\/logs"],"dataVolumesFrom":[],"devices":[],"dns":[],"dnsSearch":[],"environment":{"ProjectName":"user-server","NAME":"userserver","ETCD_ADDR":"http:\/\/10.240.36.209:2379,http:\/\/10.240.36.210:2379,http:\/\/10.240.36.211:2379"},"imageUuid":"docker:docker-reg-bj.afmobitek.com:5000\/user-server\/debug:v7e6243b","instanceTriggeredStop":"stop","kind":"container","labels":{"io.rancher.container.pull_image":"always","io.rancher.scheduler.affinity:host_label":"captcha=1"},"logConfig":{"type":"logConfig","config":{},"driver":null},"networkMode":"managed","ports":["6005:8080\/tcp"],"privileged":false,"publishAllPorts":false,"readOnly":false,"secrets":[],"startOnCreate":true,"stdinOpen":true,"system":false,"tty":true,"version":"15a7cd8b-b2d9-4375-b305-5b6a96264a51","dataVolumesFromLaunchConfigs":[],"vcpu":1},"previousSecondaryLaunchConfigs":[],"secondaryLaunchConfigs":[],"startFirst":false},"toServiceStrategy":null},"uuid":"f8b9479f-1792-47d0-b631-6e15aa8457f1","vip":null}
getServiceConfig status is 200
putUpgradeConfig success
Finished: SUCCESS
